<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>報單管理</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <p style="margin-top: 50px;"></p>
    <!--固定在頁面頂部-->
    <div class="tabs-wrapper">
        <div class="tabs">
            <div class="tab-links active" onclick="openTab('header')">出口報單表頭</div>
            <div class="tab-links" onclick="openTab('items')">出口報單項次</div>
            <div class="tab-links" onclick="openTab('copy')">申請報單副本</div>
            <div class="tab-links" onclick="openTab('bonded')">保稅相關信息</div>
        </div>
    </div>

    <!--報單表頭-->    
    <div id="header" class="tab active">
        <p style="margin-top: 30px;"></p>
        <div class="header-section">
            <div class="header-group">
                <label for="LOT_NO">運單號</label>
                <input type="text" id="LOT_NO" name="LOT_NO">
            </div>
            <div class="header-group">
                <label for="SHPR_BAN_ID">出口人統一編號</label>
                <input type="text" id="SHPR_BAN_ID" name="SHPR_BAN_ID">
            </div>
            <div class="header-group">
                <label for="SHPR_BONDED_ID">海關監管編號</label>
                <input type="text" id="SHPR_BONDED_ID" name="SHPR_BONDED_ID">
            </div>
            <div class="header-group">
                <label for="SHPR_C_NAME">出口人中文名稱</label>
                <input type="text" id="SHPR_C_NAME" name="SHPR_C_NAME">
            </div>
            <div class="header-group">
                <label for="SHPR_E_NAME">出口人英文名稱</label>
                <input type="text" id="SHPR_E_NAME" name="SHPR_E_NAME">
            </div>
            <div class="header-group">
                <label for="SHPR_E_ADDR">出口人中/英地址</label>
                <input type="text" id="SHPR_E_ADDR" name="SHPR_E_ADDR">
            </div>
            <hr>
            <div class="header-group">
                <label for="CNEE_C_NAME">買方中文名稱</label>
                <input type="text" id="CNEE_C_NAME" name="CNEE_C_NAME">
            </div>
            <div class="header-group">
                <label for="CNEE_E_NAME">買方英文名稱</label>
                <input type="text" id="CNEE_E_NAME" name="CNEE_E_NAME">
            </div>
            <div class="header-group">
                <label for="CNEE_E_ADDR">買方中/英地址</label>
                <input type="text" id="CNEE_E_ADDR" name="CNEE_E_ADDR">
            </div>
            <div class="header-group">
                <label for="CNEE_COUNTRY_CODE">買方國家代碼</label>
                <input type="text" id="CNEE_COUNTRY_CODE" name="CNEE_COUNTRY_CODE"
                placeholder="範例：HK、CN、KR、SG（英文代碼）">
            </div>
            <div class="header-group">
                <label for="CNEE_BAN_ID">買方統一編號</label>
                <input type="text" id="CNEE_BAN_ID" name="CNEE_BAN_ID"
                placeholder="（非台灣營業公司此欄免填）">
            </div>            
            <hr>
            <div class="header-group">
                <label for="BUYER_E_NAME">收方名稱</label>
                <input type="text" id="BUYER_E_NAME" name="BUYER_E_NAME"
                placeholder="（與買方名稱相同此欄免填）">
            </div>
            <div class="header-group">
                <label for="BUYER_E_ADDR">收方地址</label>
                <input type="text" id="BUYER_E_ADDR" name="BUYER_E_ADDR"
                placeholder="（與買方地址相同此欄免填）">
            </div>
            <div class="header-group">
                <label for="TO_CODE">目的地(代碼)</label>
                <input type="text" id="TO_CODE" name="TO_CODE"
                placeholder="範例：HKHKG、CNCAN、KRICN、SGSIN（英文代碼）">
            </div>
            <div class="header-group">
                <label for="TO_DESC">目的地(名稱)</label>
                <input type="text" id="TO_DESC" name="TO_DESC"
                placeholder="範例：HONG KONG、GUANGZHOU、KOREA、SINGAPORE（英文名稱）">
            </div>
        </div>
        <hr>

        <div class="header-section">
            <div class="header-group">
                <label for="TOT_CTN">總件數</label>
                <input type="number" id="TOT_CTN" name="TOT_CTN" min="0" step="1">
            </div>
            <div class="header-group">
                <label for="DOC_CTN_UM">總件數單位</label>
                <input type="text" id="DOC_CTN_UM" name="DOC_CTN_UM"
                placeholder="範例：CTN、PKG、BOX、PLT（英文代碼）">
            </div>
            <div class="header-group">
                <label for="CTN_DESC">包裝說明</label>
                <input type="text" id="CTN_DESC" name="CTN_DESC"
                placeholder="（一般倉或ECFA包裝說明）">
            </div>
            <div class="header-group">
                <label for="DCL_GW">總毛重</label>
                <input type="number" id="DCL_GW" name="DCL_GW" min="0">
            </div>
            <div class="header-group">
                <label for="DCL_NW">總淨重</label>
                <input type="number" id="DCL_NW" name="DCL_NW" min="0">
            </div>
        </div>
        <hr>

        <div class="header-section">
            <div class="header-group">
                <label for="DCL_DOC_TYPE">報單類別</label>
                <input type="text" id="DCL_DOC_TYPE" name="DCL_DOC_TYPE" list="member"
                placeholder="（下拉式選單）">
                <datalist id="member">
                    <option value="G5">國貨出口</option>
                    <option value="G3">外貨復出口</option>
                    <option value="B8">保稅廠進口貨物（原料）復出口</option>
                    <option value="B9">保稅廠產品出口</option>
                    <option value="D5">保稅倉貨物出口</option>
                    <option value="F5">自由港區貨物出口</option>
                </datalist>            
            </div>
            <div class="header-group">
                <label for="TERMS_SALES">貿易條件</label>
                <input type="text" id="TERMS_SALES" name="TERMS_SALES" list="terms"
                placeholder="（下拉式選單）">
                <datalist id="terms">
                    <option value="EXW">需填列應加費用，不得填列運保費</option>
                    <option value="FOB">不含運費、保險費</option>
                    <option value="CFR">含運費</option>
                    <option value="C&I">含保險費</option>
                    <option value="CIF">含運費、保險費</option>
                </datalist>              
            </div>
            <div class="header-group">
                <label for="CURRENCY">幣別</label>
                <input type="text" id="CURRENCY" name="CURRENCY"
                placeholder="範例：TWD、USD、CNY、JPY、EUR（英文代碼）">
            </div>
            <div class="header-group">
                <label for="CAL_IP_TOT_ITEM_AMT">總金額</label>
                <input type="number" id="CAL_IP_TOT_ITEM_AMT" name="CAL_IP_TOT_ITEM_AMT" min="0"
                placeholder="（若為台幣金額不可有小數點）">
            </div>
            <hr>
            <div class="header-group">
                <label for="FRT_AMT">運費</label>
                <input type="number" id="FRT_AMT" name="FRT_AMT" min="0"
                placeholder="（CFR、CIF 需填列運費）">
            </div>   
            <div class="header-group">
                <label for="INS_AMT">保險費</label>
                <input type="number" id="INS_AMT" name="INS_AMT" min="0"
                placeholder="（C&I、CIF 需填列保險費）">
            </div>
            <div class="header-group">
                <label for="ADD_AMT">應加費用</label>
                <input type="number" id="ADD_AMT" name="ADD_AMT" min="0"
                placeholder="（EXW 需填列應加費用）">
            </div>
            <div class="header-group">
                <label for="SUBTRACT_AMT">應減費用</label>
                <input type="number" id="SUBTRACT_AMT" name="SUBTRACT_AMT" min="0">
            </div>       
        </div> 
        <hr>
        <div class="header-section">
            <div class="header-group">
                <label for="DOC_MARKS_DESC">標記及貨櫃號碼</label>
                <textarea id="DOC_MARKS_DESC" name="DOC_MARKS_DESC" rows="5"></textarea>
            </div>
            <div class="header-group">
                <label for="DOC_OTR_DESC">其它申報事項</label>
                <textarea id="DOC_OTR_DESC" name="DOC_OTR_DESC" rows="5"></textarea>
            </div>
            <div class="header-group">
                <label for="REMARK1">REMARKS</label>
                <textarea id="REMARK1" name="REMARK1" rows="5">聯繫人電話/分機:</textarea>
            </div>
        </div>
        <p style="margin-bottom: 50px;"></p>
    </div>

    <!--報單項次-->
    <div id="items" class="tab">
        <div class="add-buttons">
            <button onclick="openItemModal()">新增項次（可複製）</button>
            <button onclick="openSpecifyFieldModal()">指定填列欄位資料</button>
            <button onclick="openAdjustOrderModal()">調整項次順序</button>
            <button onclick="openToggleFieldsModal()">顯示隱藏欄位</button>
        </div>
        <!-- 顯示隱藏欄位彈跳框 -->
        <div id="toggle-fields-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>顯示/隱藏欄位</h2>
                </div>
                <div class="header-group">
                    <label for="field-select">選擇欄位</label>
                    <select id="field-select" multiple style="height: 300px;">
                        <option value="TRADE_MARK">商標</option>
                        <option value="CCC_CODE">稅則</option>
                        <option value="ST_MTD">統計方式</option>
                        <option class="separator" disabled>──────────</option>
                        <option value="ORG_COUNTRY">生產國別</option>
                        <option value="ORG_IMP_DCL_NO">原進口報單號碼</option>
                        <option value="ORG_IMP_DCL_NO_ITEM">原進口報單項次</option>
                        <option class="separator" disabled>──────────</option>
                        <option value="SELLER_ITEM_CODE">賣方料號</option>
                        <option value="BOND_NOTE">保稅貨物註記</option>
                        <option class="separator" disabled>──────────</option>
                        <option value="GOODS_MODEL">型號</option>
                        <option value="GOODS_SPEC">規格</option>
                        <option value="CERT_NO">產證號碼</option>
                        <option value="CERT_NO_ITEM">產證項次</option>
                        <option class="separator" disabled>──────────</option>
                        <option value="ORG_DCL_NO">原進倉報單號碼</option>
                        <option value="ORG_DCL_NO_ITEM">原進倉報單項次</option>
                        <option class="separator" disabled>──────────</option>
                        <option value="EXP_NO">輸出許可號碼</option>
                        <option value="EXP_SEQ_NO">輸出許可項次</option>
                        <option class="separator" disabled>──────────</option>
                        <option value="WIDE">寬度(幅寬)</option>
                        <option value="WIDE_UM">寬度單位</option>
                        <option value="LENGT_">長度(幅長)</option>
                        <option value="LENGTH_UM">長度單位</option>
                        <option class="separator" disabled>──────────</option>
                        <option value="ST_QTY">統計數量</option>
                        <option value="ST_UM">統計單位</option>
                    </select>
                </div>
                <div class="floating-buttons">
                    <button onclick="applyToggleFields()">套用</button>
                    <button onclick="closeToggleFieldsModal()">取消</button>
                </div>
            </div>
        </div>

        <div class="item-row item-header">
            <div class="form-group fix">
                <label>項次</label>
            </div>
            <div class="form-group fix">
                <label>大品名註記</label>
            </div>
            <div class="form-group DESCRIPTION">
                <label>品名</label>
            </div>
            <div class="form-group QTY">
                <label>數量</label>
            </div>
            <div class="form-group DOC_UM">
                <label>單位</label>
            </div>
            <div class="form-group DOC_UNIT_P">
                <label>單價</label>
            </div>
            <div class="form-group DOC_TOT_P">
                <label>金額</label>
            </div>
            <div class="form-group NET_WT">
                <label>淨重</label>
            </div>
            <div class="form-group TRADE_MARK hidden">
                <label>商標</label>
            </div>
            <div class="form-group CCC_CODE hidden">
                <label>稅則</label>
            </div>
            <div class="form-group ST_MTD hidden">
                <label>統計方式</label>
            </div>
            <div class="form-group ORG_COUNTRY hidden">
                <label>生產國別</label>
            </div>
            <div class="form-group ORG_IMP_DCL_NO hidden">
                <label>原進口報單號碼</label>
            </div>
            <div class="form-group ORG_IMP_DCL_NO_ITEM hidden">
                <label>原進口報單項次</label>
            </div>
            <div class="form-group SELLER_ITEM_CODE hidden">
                <label>賣方料號</label>
            </div>
            <div class="form-group BOND_NOTE hidden">
                <label>保稅貨物註記</label>
            </div>
            <div class="form-group GOODS_MODEL hidden">
                <label>型號</label>
            </div>
            <div class="form-group GOODS_SPEC hidden">
                <label>規格</label>
            </div>
            <div class="form-group CERT_NO hidden">
                <label>產證號碼</label>
            </div>
            <div class="form-group CERT_NO_ITEM hidden">
                <label>產證項次</label>
            </div>
            <div class="form-group ORG_DCL_NO hidden">
                <label>原進倉報單號碼</label>
            </div>
            <div class="form-group ORG_DCL_NO_ITEM hidden">
                <label>原進倉報單項次</label>
            </div>
            <div class="form-group EXP_NO hidden">
                <label>輸出許可號碼</label>
            </div>
            <div class="form-group EXP_SEQ_NO hidden">
                <label>輸出許可項次</label>
            </div>
            <div class="form-group WIDE hidden">
                <label>寬度(布寬)</label>
            </div>
            <div class="form-group WIDE_UM hidden">
                <label>寬度單位</label>
            </div>
            <div class="form-group LENGT_ hidden">
                <label>長度(布長)</label>
            </div>
            <div class="form-group LENGTH_UM hidden">
                <label>長度單位</label>
            </div>     
            <div class="form-group ST_QTY hidden">
                <label>統計數量</label>
            </div>  
            <div class="form-group ST_UM hidden">
                <label>統計單位</label>
            </div>         
            <div class="form-group">
                <label>操作</label>
            </div>
        </div>
        <p style="margin-top: 10px;"></p>        
        <div id="item-container"></div>
    </div>
    
    <!-- 新增項次彈跳框 -->
    <div id="item-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header" id="item-modal-header">
                <h2>新增項次（可複製）</h2>
            </div>
            <div class="flex-group">
                <input type="checkbox" id="ITEM_NO" name="HAS_MAJOR_NAME" onchange="toggleMajorName(event)">
                <label for="ITEM_NO">大品名註記（勾選大品名註記時，只需填寫品名）</label>
            </div>
            <div class="header-group">
                <label for="COPY_ITEM">選擇要複製的項次</label>
                <select id="COPY_ITEM">
                    <option value="">選擇項次</option>
                </select>
                <button onclick="copyItem()">複製</button>
            </div>
            <div class="header-group">
                <label for="DESCRIPTION">品名</label>
                <textarea id="DESCRIPTION" class="DESCRIPTION" rows="5"></textarea>
            </div>
            <div class="header-group">
                <label for="QTY">數量</label>
                <input type="number" id="QTY" class="QTY" min="0" oninput="calculateAmount(event)">
            </div>
            <div class="header-group">
                <label for="DOC_UM">單位</label>
                <input type="text" id="DOC_UM" class="DOC_UM" placeholder="範例：EAC、PCE、SET、YRD、MTR（英文代碼）">
            </div>
            <div class="header-group">
                <label for="DOC_UNIT_P">單價</label>
                <input type="number" id="DOC_UNIT_P" class="DOC_UNIT_P" min="0" oninput="calculateAmount(event)">
            </div>
            <div class="header-group">
                <label for="DOC_TOT_P">金額</label>
                <input type="number" id="DOC_TOT_P" class="DOC_TOT_P" min="0" readonly>
            </div>
            <div class="header-group">
                <label for="NET_WT">淨重</label>
                <input type="number" id="NET_WT" class="NET_WT" min="0">
            </div>
            <div class="header-group">
                <label for="TRADE_MARK">商標</label>
                <input type="text" id="TRADE_MARK" class="TRADE_MARK" placeholder="範例：NO BRAND（無商標）、FIG（圖樣）、文字（字樣）">
            </div>
            <div class="header-group">
                <label for="CCC_CODE">稅則</label>
                <input type="text" id="CCC_CODE" class="CCC_CODE">
            </div>
            <div class="header-group">
                <label for="ST_MTD">統計方式</label>
                <input type="text" id="ST_MTD" class="ST_MTD" name="ST_MTD" list="method">
                <datalist id="method">
                    <option value="02">國貨銷售</option>
                    <option value="04">國貨樣品/贈送</option>
                    <option value="81">洋貨銷售</option>
                    <option value="82">洋貨樣品/贈送/不良品退回</option>
                </datalist>
            </div>
            <hr>
            <div class="header-group">洋貨復出口核銷欄位</div>
            <div class="header-group">
                <label for="ORG_COUNTRY">生產國別</label>
                <input type="text" id="ORG_COUNTRY" class="ORG_COUNTRY" placeholder="範例：US、CN、JP、GB（英文代碼）">
            </div>
            <div class="header-group">
                <label for="ORG_IMP_DCL_NO">原進口報單號碼</label>
                <input type="text" id="ORG_IMP_DCL_NO" class="ORG_IMP_DCL_NO" placeholder="範例：CX  13709IPORT（中間為兩位空格）">
            </div>
            <div class="header-group">
                <label for="ORG_IMP_DCL_NO_ITEM">原進口報單項次</label>
                <input type="text" id="ORG_IMP_DCL_NO_ITEM" class="ORG_IMP_DCL_NO_ITEM">
            </div>
            <hr>
            <div class="header-group">保稅貨物欄位</div>
            <div class="header-group">
                <label for="SELLER_ITEM_CODE">賣方料號</label>
                <input type="text" id="SELLER_ITEM_CODE" class="SELLER_ITEM_CODE">
            </div>
            <div class="header-group">
                <label for="BOND_NOTE">保稅貨物註記</label>
                <input type="text" id="BOND_NOTE" class="BOND_NOTE">
            </div>            
            <hr>
            <div class="header-group">ECFA產證欄位</div>
            <div class="header-group">
                <label for="GOODS_MODEL">型號</label>
                <input type="text" id="GOODS_MODEL" class="GOODS_MODEL">
            </div>
            <div class="header-group">
                <label for="GOODS_SPEC">規格</label>
                <input type="text" id="GOODS_SPEC" class="GOODS_SPEC">
            </div>
            <div class="header-group">
                <label for="CERT_NO">產證號碼</label>
                <input type="text" id="CERT_NO" class="CERT_NO">
            </div>
            <div class="header-group">
                <label for="CERT_NO_ITEM">產證項次</label>
                <input type="text" id="CERT_NO_ITEM" class="CERT_NO_ITEM">
            </div>
            <hr>
            <div class="header-group">D5保稅倉核銷欄位</div>
            <div class="header-group">
                <label for="ORG_DCL_NO">原進倉報單號碼</label>
                <input type="text" id="ORG_DCL_NO" class="ORG_DCL_NO">
            </div>
            <div class="header-group">
                <label for="ORG_DCL_NO_ITEM">原進倉報單項次</label>
                <input type="text" id="ORG_DCL_NO_ITEM" class="ORG_DCL_NO_ITEM">
            </div>
            <hr>
            <div class="header-group">管制品欄位</div>
            <div class="header-group">
                <label for="EXP_NO">輸出許可號碼</label>
                <input type="text" id="EXP_NO" class="EXP_NO">
            </div>
            <div class="header-group">
                <label for="EXP_SEQ_NO">輸出許可項次</label>
                <input type="text" id="EXP_SEQ_NO" class="EXP_SEQ_NO">
            </div>
            <hr>
            <div class="header-group">布貨品欄位</div>
            <div class="header-group">
                <label for="WIDE">寬度(幅寬)</label>
                <input type="text" id="WIDE" class="WIDE">
            </div>
            <div class="header-group">
                <label for="WIDE_UM">寬度單位</label>
                <input type="text" id="WIDE_UM" class="WIDE_UM">
            </div>
            <div class="header-group">
                <label for="LENGT_">長度(幅長)</label>
                <input type="text" id="LENGT_" class="LENGT_">
            </div>
            <div class="header-group">
                <label for="LENGTH_UM">長度單位</label>
                <input type="text" id="LENGTH_UM" class="LENGTH_UM">
            </div> 
            <hr>
            <div class="header-group">與數量單位不同另外填列</div>
            <div class="header-group">
                <label for="ST_QTY">統計數量</label>
                <input type="text" id="ST_QTY" class="ST_QTY">
            </div>
            <div class="header-group">
                <label for="ST_UM">統計單位</label>
                <input type="text" id="ST_UM" class="ST_UM">
            </div>           
            <div class="floating-buttons">
                <button onclick="saveItem()">儲存</button>
                <button onclick="closeItemModal()">取消</button>
            </div>
        </div>
    </div>

    <!-- 調整順序彈跳框 -->
    <div id="adjust-order-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header" id="adjust-order-modal-header">
                <h2>調整順序</h2>
            </div>
            <h4>【直接拖曳調整項次的排列順序】</h4>
            <div id="order-list" class="order-list">
                <!-- 動態生成的項次列表 -->
            </div>
            <div class="floating-buttons">
                <button onclick="saveNewOrder()">儲存</button>
                <button onclick="closeOrderModal()">取消</button>
            </div>
        </div>
    </div>

    <!-- 指定填列欄位資料的彈跳框 -->
    <div id="specify-field-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header" id="specify-field-modal-header">
                <h2>指定填列欄位資料</h2>
            </div>
            <div class="header-group">
                <label for="specify-mode">模式</label>
                <select id="specify-mode" onchange="toggleSpecifyMode()">
                    <option value="custom">自定義填列內容</option>
                    <option value="copy">從源項次複製內容</option>
                </select>
            </div>
            <div id="custom-content" class="specify-mode-content">
                <div class="header-group">
                    <label for="specify-item-numbers">項次 (例如: 3,5-7)</label>
                    <input type="text" id="specify-item-numbers">
                </div>
                <div class="header-group">
                    <label for="specify-field-name">欄位名稱</label>
                    <select id="specify-field-name">
                        <option value="DESCRIPTION">品名</option>
                        <option value="QTY">數量</option>
                        <option value="DOC_UM">單位</option>
                        <option value="DOC_UNIT_P">單價</option>
                        <option value="DOC_TOT_P">金額</option>
                        <option value="NET_WT">淨重</option>
                        <option value="TRADE_MARK">商標</option>
                        <option value="CCC_CODE">稅則</option>
                        <option value="ST_MTD">統計方式</option>
                        <option class="separator" disabled>──────────</option>
                        <option value="ORG_COUNTRY">生產國別</option>
                        <option value="ORG_IMP_DCL_NO">原進口報單號碼</option>
                        <option value="ORG_IMP_DCL_NO_ITEM">原進口報單項次</option>
                        <option class="separator" disabled>──────────</option>
                        <option value="SELLER_ITEM_CODE">賣方料號</option>
                        <option value="BOND_NOTE">保稅貨物註記</option>
                        <option class="separator" disabled>──────────</option>
                        <option value="GOODS_MODEL">型號</option>
                        <option value="GOODS_SPEC">規格</option>
                        <option value="CERT_NO">產證號碼</option>
                        <option value="CERT_NO_ITEM">產證項次</option>
                        <option class="separator" disabled>──────────</option>
                        <option value="ORG_DCL_NO">原進倉報單號碼</option>
                        <option value="ORG_DCL_NO_ITEM">原進倉報單項次</option>
                        <option class="separator" disabled>──────────</option>
                        <option value="EXP_NO">輸出許可號碼</option>
                        <option value="EXP_SEQ_NO">輸出許可項次</option>
                        <option class="separator" disabled>──────────</option>
                        <option value="WIDE">寬度(幅寬)</option>
                        <option value="WIDE_UM">寬度單位</option>
                        <option value="LENGT_">長度(幅長)</option>
                        <option value="LENGTH_UM">長度單位</option>
                        <option class="separator" disabled>──────────</option>
                        <option value="ST_QTY">統計數量</option>
                        <option value="ST_UM">統計單位</option>
                    </select>
                </div>
                <!-- 新增起始編號輸入框，只在選擇產證序號時顯示 -->
                <div id="start-number-container" style="display: none;">
                    <label for="start-number">起始編號:</label>
                    <input type="number" id="start-number" value="1" min="1" class="small-input">
                </div>

                <div class="header-group">
                    <label for="specify-field-value">填列內容</label>
                    <textarea id="specify-field-value" rows="3"></textarea>
                </div>
            </div>
            <div id="copy-content" class="specify-mode-content" style="display:none;">
                <div class="header-group">
                    <label for="source-item-number">源項次</label>
                    <select id="source-item-number">
                        <option value="">選擇項次</option>
                    </select>
                </div>
                <div class="header-group">
                    <label for="specify-field-names-copy">欄位名稱</label>
                    <select id="specify-field-names-copy" multiple style="height: 300px;">
                        <option value="DESCRIPTION">品名</option>
                        <option value="QTY">數量</option>
                        <option value="DOC_UM">單位</option>
                        <option value="DOC_UNIT_P">單價</option>
                        <option value="DOC_TOT_P">金額</option>
                        <option value="NET_WT">淨重</option>
                        <option value="TRADE_MARK">商標</option>
                        <option value="CCC_CODE">稅則</option>
                        <option value="ST_MTD">統計方式</option>
                        <option class="separator" disabled>──────────</option>
                        <option value="ORG_COUNTRY">生產國別</option>
                        <option value="ORG_IMP_DCL_NO">原進口報單號碼</option>
                        <option value="ORG_IMP_DCL_NO_ITEM">原進口報單項次</option>
                        <option class="separator" disabled>──────────</option>
                        <option value="SELLER_ITEM_CODE">賣方料號</option>
                        <option value="BOND_NOTE">保稅貨物註記</option>
                        <option class="separator" disabled>──────────</option>
                        <option value="GOODS_MODEL">型號</option>
                        <option value="GOODS_SPEC">規格</option>
                        <option value="CERT_NO">產證號碼</option>
                        <option value="CERT_NO_ITEM">產證項次</option>
                        <option class="separator" disabled>──────────</option>
                        <option value="ORG_DCL_NO">原進倉報單號碼</option>
                        <option value="ORG_DCL_NO_ITEM">原進倉報單項次</option>
                        <option class="separator" disabled>──────────</option>
                        <option value="EXP_NO">輸出許可號碼</option>
                        <option value="EXP_SEQ_NO">輸出許可項次</option> 
                        <option class="separator" disabled>──────────</option>
                        <option value="WIDE">寬度(幅寬)</option>
                        <option value="WIDE_UM">寬度單位</option>
                        <option value="LENGT_">長度(幅長)</option>
                        <option value="LENGTH_UM">長度單位</option>
                        <option class="separator" disabled>──────────</option>
                        <option value="ST_QTY">統計數量</option>
                        <option value="ST_UM">統計單位</option>
                    </select>
                </div>
                <div class="header-group">
                    <label for="target-item-numbers">目標項次 (例如: 1,7-8)</label>
                    <input type="text" id="target-item-numbers">
                </div>
            </div>
            <div class="header-group">
                <label for="overwrite-option">覆蓋選項</label>
                <select id="overwrite-option">
                    <option value="all">全部覆蓋</option>
                    <option value="empty">覆蓋未填列之項次</option>
                    <option value="specified">覆蓋已填列之項次</option>
                </select>
            </div>
            <div class="floating-buttons">
                <button onclick="applyFieldData()">儲存</button>
                <button onclick="closeSpecifyFieldModal()">取消</button>
            </div>
        </div>
    </div>

    <!--報單副本-->
    <div id="copy" class="tab">
        <p style="margin-top: 30px;"></p>
        <div class="header-section">
            <div class="flex-group">
                <input type="checkbox" id="copy_3_e" name="copy_option">申請沖退原料稅（E化退稅）<br>
            </div>
            <div class="flex-group">
                <input type="checkbox" id="copy_3" name="copy_option">申請報單副本第三聯（沖退原料稅用聯）<br>
            </div>
            <div class="flex-group">
                <input type="checkbox" id="copy_4" name="copy_option">申請報單副本第四聯（退內地稅用聯）<br>
            </div>
            <div class="flex-group">
                <input type="checkbox" id="copy_5" name="copy_option">申請報單副本第五聯（出口證明用聯）<br>
            </div>  
        </div>
        <input type="hidden" id="APP_DUTY_REFUND" value="">
        <input type="hidden" id="MARK_TOT_LINES" value="">
        <input type="hidden" id="EXAM_TYPE" value="">
        <input type="hidden" id="COPY_QTY" value="">
    </div>
    
    <!-- 用於顯示變數值 -->
    <div id="variables" style="display:none;">
        <input type="hidden" id="APP_DUTY_REFUND" value="N">
        <input type="hidden" id="MARK_TOT_LINES" value="N">
        <input type="hidden" id="EXAM_TYPE" value="">
        <input type="hidden" id="COPY_QTY" value="0">
    </div>

    <!--保稅貨物-->
    <div id="bonded" class="tab">
        <p style="margin-top: 30px;"></p>        
        <div class="header-section">
            <div class="header-group">
                <label for="FAC_BAN_ID_EX">保稅廠統一編號</label>
                <input type="text" id="FAC_BAN_ID_EX" name="FAC_BAN_ID_EX">
            </div>
            <div class="header-group">
                <label for="FAC_BONDED_ID_EX">保稅廠監管編號</label>
                <input type="text" id="FAC_BONDED_ID_EX" name="FAC_BONDED_ID_EX">
            </div>
            <div class="header-group">
                <label for="RESERVED_STR_1">用料清表文號</label>
                <input type="text" id="RESERVED_STR_1" name="RESERVED_STR_1">
            </div>
            <div class="header-group">
                <label for="RESERVED_STR_2">保出字號</label>
                <input type="text" id="RESERVED_STR_2" name="RESERVED_STR_2">
            </div>
            <hr>
            <div class="header-group">
                <label for="FAC_BAN_ID">出倉保稅倉庫統一編號</label>
                <input type="text" id="FAC_BAN_ID" name="FAC_BAN_ID">
            </div>
            <div class="header-group">
                <label for="FAC_BONDED_ID">出倉保稅倉庫代碼</label>
                <input type="text" id="FAC_BONDED_ID" name="FAC_BONDED_ID">
            </div>
            <div class="header-group">
                <label for="IN_BONDED_BAN">進倉保稅倉庫統一編號</label>
                <input type="text" id="IN_BONDED_BAN" name="IN_BONDED_BAN">
            </div>
            <div class="header-group">
                <label for="IN_BONDED_CODE">進倉保稅倉庫代碼</label>
                <input type="text" id="IN_BONDED_CODE" name="IN_BONDED_CODE">
            </div>
        </div>
    </div>

    <div class="import-export-buttons">
        <input type="file" id="import-excel" accept=".xlsx, .xls" style="display:none;">
        <button class="excel-btn" onclick="document.getElementById('import-excel').click();">匯入Excel</button>
        <button class="excel-btn" id="export-excel">匯出Excel</button>
        <input type="file" id="import-xml" accept=".xml" style="display:none;">        
        <button class="xml-btn" onclick="document.getElementById('import-xml').click();">匯入XML</button>        
        <button class="xml-btn" id="export-to-xml">匯出XML</button>
        <button class="pdf-btn" onclick="exportToPDF()">出口報單預覽</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>    
    <script src="script.js"></script>

</body>
</html>
